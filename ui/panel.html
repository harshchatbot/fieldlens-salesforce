<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FieldLens</title>
    <link rel="stylesheet" href="panel.css" />
  </head>
  <body>
    <div class="panel">
      <header class="panel-header">
        <button id="brandLinkBtn" class="brand-block brand-link-btn" type="button" aria-label="Open TechFi Labs website">
          <img class="brand-logo" src="techfi-logo.svg" alt="TechFi Labs logo" />
          <div class="brand-copy">
            <h1>FieldLens</h1>
            <p class="brand-subtitle">by TechFi Labs</p>
            <p id="modeBadge" class="mode-badge">Mode: Quick</p>
            <p id="contextLine" class="context-line">Waiting for Salesforce page context...</p>
            <p id="freshnessBadge" class="freshness-badge hidden"></p>
          </div>
        </button>
        <button id="closeBtn" class="icon-btn" type="button" aria-label="Close panel">Ã—</button>
      </header>

      <section id="errorBanner" class="error-banner hidden"></section>
      <section id="warningBanner" class="warning-banner hidden"></section>
      <section id="diagnosticsSection" class="diagnostics hidden">
        <details id="diagnosticsDetails">
          <summary>Diagnostics <span id="diagnosticsCount" class="diagnostics-count">0</span></summary>
          <ul id="diagnosticsList" class="diagnostics-list"></ul>
        </details>
      </section>

      <section id="recordFieldPicker" class="field-picker hidden">
        <label for="fieldSearchInput">Select field</label>
        <input id="fieldSearchInput" type="text" placeholder="Search by label or API name" autocomplete="off" />
        <select id="fieldSelect" size="10"></select>
      </section>

      <section class="scan-mode">
        <span class="mode-label">Scan Mode</span>
        <div class="mode-toggle" role="radiogroup" aria-label="Scan mode">
          <button id="modeQuickBtn" type="button" class="mode-btn mode-btn-active" aria-pressed="true">Quick</button>
          <button id="modeDeepBtn" type="button" class="mode-btn" aria-pressed="false">Deep</button>
        </div>
      </section>

      <section class="actions">
        <button id="scanBtn" class="primary-btn" type="button">Run Impact Scan</button>
        <button id="copyBtn" class="secondary-btn" type="button" disabled>Copy Summary</button>
      </section>
      <section class="actions">
        <button id="exportCsvBtn" class="secondary-btn" type="button" disabled>Export CSV</button>
        <button id="settingsBtn" class="secondary-btn" type="button">Settings</button>
      </section>
      <section id="settingsPanel" class="settings-panel hidden">
        <label class="settings-row">
          <span>Default scan mode</span>
          <select id="defaultScanModeSelect">
            <option value="quick">Quick</option>
            <option value="deep">Deep</option>
          </select>
        </label>
        <label class="settings-row settings-checkbox">
          <input id="hideZeroGroupsCheckbox" type="checkbox" />
          <span>Hide zero-result sections</span>
        </label>
      </section>

      <section id="resultSearchWrap" class="result-search hidden">
        <input id="resultSearchInput" type="text" placeholder="Filter results across all groups" autocomplete="off" />
      </section>
      <section id="accordionControls" class="accordion-controls hidden">
        <button id="expandAllBtn" class="secondary-btn accordion-btn" type="button">Expand all</button>
        <button id="collapseAllBtn" class="secondary-btn accordion-btn" type="button">Collapse all</button>
      </section>

      <section id="loadingState" class="loading hidden" aria-live="polite">
        <div class="spinner-wrap">
          <div class="spinner" aria-hidden="true"></div>
        </div>
        <div class="loading-text">
          <span id="loadingTextValue">Scanning references...</span>
          <div class="loading-bars" aria-hidden="true">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </section>

      <section id="emptyState" class="empty-state hidden">No impact found for this field.</section>

      <section id="topImpact" class="top-impact hidden">
        <div class="top-impact-head">
          <strong>Top Impact</strong>
          <span id="topImpactCount" class="top-impact-count">0</span>
        </div>
        <ul id="topImpactList" class="top-impact-list"></ul>
      </section>

      <section id="flsControls" class="fls-controls hidden">
        <div id="flsCounters" class="fls-counters"></div>
        <div class="fls-filter-row">
          <button type="button" class="fls-filter-btn fls-filter-btn-active" data-fls-filter="all">All</button>
          <button type="button" class="fls-filter-btn" data-fls-filter="profile">Profiles</button>
          <button type="button" class="fls-filter-btn" data-fls-filter="permissionSet">Perm Sets</button>
          <button type="button" class="fls-filter-btn" data-fls-filter="readEdit">Read + Edit</button>
          <button type="button" class="fls-filter-btn" data-fls-filter="read">Read only</button>
        </div>
      </section>

      <section id="resultsContainer" class="results hidden"></section>

    </div>

    <script src="panel.js"></script>
  </body>
</html>
